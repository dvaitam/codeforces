package main

import (
	"bufio"
	"bytes"
	"container/heap"
	"fmt"
	"os"
	"os/exec"
	"strconv"
	"strings"
)

// Embedded copy of testcasesC2.txt so the verifier is self-contained.
const testcasesRaw = `100
19
-202 -441 48 -587 -276 728 -168 -355 496 -958 -912 -607 959 -597 236 702 -666 734 141
30
-835 -487 27 -411 410 -4 -141 666 -357 737 379 521 915 433 789 427 -211 -889 768 873 -765 827 -880 -315 -673 562 -455 259 474 144
29
-368 122 841 -151 746 876 -14 -233 -549 937 385 -817 487 -836 994 618 286 -814 36 -965 750 351 193 50 -323 957 501 672 221
7
845 154 -519 -959 -916 615 -805
47
-361 -813 670 204 782 -199 453 -738 581 827 179 929 898 888 251 87 962 770 804 -595 -432 -395 -675 861 -624 209 948 -538 -720 -734 793 -533 -472 15 614 -379 -703 504 261 -445 -582 -840 -721 839 727 359 -167
12
-593 782 205 -965 -281 101 348 -18 388 -742 546 669
48
-446 -833 839 475 432 265 745 415 774 -429 621 227 508 -549 -992 831 -707 687 -576 516 182 383 -994 -144 -740 -703 -7 102 -916 30 -348 944 -550 371 -643 -65 -352 360 804 -94 -527 926 329 305 503 -437 382 448
13
-795 -284 3 -443 -278 103 205 984 -421 -554 -415 131 -197
5
-642 -231 -767 954 208
42
-323 983 630 -535 -742 -671 241 -839 -659 351 982 299 -135 -343 -574 592 295 481 903 -207 -185 -296 -32 681 736 -212 366 -15 -544 -921 -929 -705 -69 850 270 -895 -871 615 607 -420 372 -800
11
-206 44 691 768 -26 261 313 58 -221 313 558
10
-29 19 -902 427 -215 435 580 470 -820 -158
35
409 983 884 -857 -40 380 -596 239 663 -158 88 832 -693 180 222 61 812 36 -985 832 -294 212 460 -769 -105 529 -8 -603 -15 915 -980 974 -76 -353 334
18
-145 -931 -80 930 767 765 748 470 -255 954 744 127 -539 923 996 -670 877 -872
15
-369 -263 952 369 -52 523 -267 396 29 -453 600 0 225 -935 -942
27
-274 -214 798 760 246 399 -188 511 -453 239 225 -785 -246 24 -161 -472 -255 436 321 461 362 -56 -932 -134 184 325 940
41
-296 655 -815 -838 701 133 109 -557 -130 36 -438 722 820 593 771 749 599 -978 -301 -968 116 924 595 810 -122 187 -769 79 -423 -163 -58 -846 992 586 863 -264 -917 928 -81 -859 -696
1
-506
34
-722 248 -939 818 -21 -927 538 176 281 -863 88 441 -606 -643 227 4 795 31 -920 438 -60 412 739 968 -145 -288 677 -998 -906 341 205 -151 73 93
32
-133 -410 -500 -158 30 -929 256 -415 -787 -578 38 -142 -517 -927 970 551 140 83 171 -842 -349 -248 919 51 -339 57 551 -895 925 -84 307 924
18
-215 -529 238 -893 787 880 214 810 22 -936 779 -2 1000 -700 870 -820 -956 724
1
337
33
830 259 -197 -217 244 -770 -557 -383 225 394 -711 -722 207 795 370 -130 832 -67 821 780 -485 947 -509 394 86 243 -575 26 435 226 470 -585 596
32
797 -432 734 -702 91 755 527 304 -987 676 -248 660 780 193 -536 -121 -984 58 457 -566 862 170 -310 -20 -687 -672 355 979 -898 813 707 463
19
-225 -84 -113 576 344 197 1000 -241 -659 897 230 -272 -231 -919 838 42 781 -957 284
21
-666 -988 -796 622 -21 587 892 484 429 -634 491 803 215 -632 -774 794 -942 90 -398 315 -82
33
-74 -419 492 127 512 828 -398 -240 -246 -665 966 -31 627 846 -867 323 670 327 381 -432 43 424 72 30 825 824 -108 847 373 916 70 271 -776
33
-219 -809 817 -937 -501 -4 54 495 -375 747 -72 -657 -689 63 -761 -829 -208 -229 600 203 98 485 -947 490 -489 802 -516 173 858 10 370 -158 919
25
-326 -686 -236 -249 799 230 67 790 -288 785 348 312 -777 886 683 611 -131 787 -979 878 99 757 -450 -58 880
17
132 -489 255 -489 34 226 858 -211 -299 -338 866 987 978 -63 980 -863 -988
17
473 -134 -827 930 243 663 -895 -318 873 848 -139 278 916 20 523 735 -603
33
-6 37 -461 -402 943 979 86 196 164 -616 104 715 248 285 444 -789 -905 298 -825 -878 -262 -444 -748 170 772 -561 304 -432 386 -856 -52 -468 84
16
-141 163 987 179 -684 30 241 218 999 759 131 -413 -145 -894 756 1000
38
-943 -315 -998 -148 274 -609 997 354 467 335 440 645 -273 -317 -577 606 -131 -162 886 183 -181 -190 -694 -610 849 248 -890 -774 -532 -290 774 156 -351 -1000 -547 562 114 -565
4
40 177 -397 707
39
-95 -242 817 171 675 -855 919 -42 588 -572 -591 792 -663 1 -430 4 -906 30 -951 986 -530 898 792 -124 -344 84 790 297 816 -953 -876 -685 373 -677 -231 -983 -571 -243 400
38
-973 -861 756 375 -452 992 -301 -960 -816 884 -147 141 285 -370 -765 994 7 880 803 646 -11 873 -867 552 293 861 -180 37 596 752 752 92 43 105 216 845 969 -412
19
-395 -994 65 81 -623 -632 -526 809 468 906 -212 -601 387 439 -861 52 -496 468 -661
15
201 290 632 -817 823 -42 -789 403 -474 731 -693 756 740 -23 989
9
-465 308 6 -97 -498 538 -33 -401 -200
17
-541 506 215 -705 601 -373 189 591 981 -641 366 -588 813 993 -893 137 -764
24
131 375 294 -17 236 -955 -368 602 304 -620 527 -120 724 -676 988 420 799 635 2 761 398 -258 749 407
10
-146 -927 -488 603 138 -804 -816 -83 -275 -823
38
-493 821 31 -607 878 312 707 -657 -174 -724 62 977 720 953 -60 473 -20 224 -760 167 998 -400 -973 15 -417 -70 524 484 -747 108 31 212 77 -902 250 -244 168 909
7
770 -477 503 -856 48 391 -241
35
480 -946 599 401 957 745 -217 -377 -854 -638 901 448 -976 977 854 -547 946 -842 229 120 -95 596 608 949 739 303 -311 723 -905 -600 -884 753 396 472 442
2
308 -437
3
449 870 -807
7
390 -314 541 750 475 -582 316
38
-573 773 844 975 111 679 -618 -493 -661 -944 -781 19 110 -831 522 33 575 -238 -924 294 916 449 345 396 -430 -330 201 618 867 -337 964 525 511 240 495 -944 993 797
41
22 -706 -929 257 478 455 185 746 763 -296 -692 642 -322 -24 -62 -299 -416 82 -131 61 -234 126 64 148 -518 -68 -910 -954 137 -684 -181 177 117 -570 989 531 321 -757 435 9 -123
5
-915 -389 385 597 -36
27
-438 807 732 610 -5 -536 20 -14 -691 -369 883 -399 -872 512 756 -551 366 -465 -42 765 689 -932 350 832 -567 357 -236
24
-620 131 -354 -255 944 -1000 -734 -237 587 837 824 -264 -337 -981 364 977 -983 -62 924 -415 -425 -801 439 -619
27
-277 858 -788 -19 -409 547 171 600 -481 755 241 666 -430 764 -326 65 -88 -181 339 -785 19 51 567 126 -456 -285 -579
17
-179 -790 -603 72 324 873 -870 -236 393 -650 568 -492 73 -89 623 -829 966
37
-232 577 920 -38 -551 -364 28 -206 972 380 -119 111 -752 683 573 -113 797 649 -734 -939 290 459 -415 83 966 386 222 -897 464 861 811 652 -64 -918 647 -209 -463
30
65 126 -591 615 270 431 816 906 -849 504 707 -434 995 -300 -112 -438 588 -5 889 115 21 -968 -356 63 -45 845 992 241 678 613
15
-875 47 962 572 -772 980 -530 -431 -309 -539 843 431 677 -995 -754
17
-504 697 -751 -459 -995 550 137 488 -114 -931 609 -108 742 808 -623 544 -517
3
735 725 394
5
745 409 999 825 -818
30
-131 133 256 -116 -984 -952 734 42 135 286 63 479 109 1000 363 -99 80 311 536 918 -75 676 104 27 -327 932 140 -154 -850 -424
13
-699 -380 -678 438 -165 499 -913 -569 417 870 553 97 91
25
-231 593 -220 -79 284 621 -541 146 -581 857 -245 -340 415 -72 -827 599 122 936 918 -380 763 747 -797 -609 895
6
-53 -957 -762 -966 651 382
14
209 120 -905 314 657 -13 505 -423 507 916 168 -16 951 -782
44
997 805 -436 387 910 522 386 624 185 -499 11 246 378 -188 -627 959 954 682 821 -390 799 856 -21 -200 -1000 -938 -123 883 143 -924 36 -95 439 777 -505 -586 790 444 76 754 411 968 622 356
30
-801 347 -325 -404 855 955 -419 657 -340 887 467 -640 834 672 682 -593 781 898 9 -825 336 780 -779 601 -545 -849 -877 -677 568 -92
26
-188 67 -556 -564 489 -308 -737 360 358 872 -499 631 -591 92 874 221 574 801 399 173 -10 722 -89 90 -823 -988
11
367 -367 774 -432 533 -154 212 -886 -243 -132 -586
28
-695 562 -691 -458 409 -693 398 306 359 519 518 112 682 -764 -514 158 856 453 462 963 628 406 -765 675 -339 -200 715 527
40
-585 933 -785 856 -58 59 497 -708 271 184 389 -377 -964 -651 -284 148 986 537 749 202 698 153 -706 527 -878 185 -995 -231 99 -759 -129 -975 501 569 442 105 899 440 -589 408
7
46 850 80 809 870 -262 -234
15
-71 968 -594 94 -594 852 544 174 -109 245 528 840 879 519 -544
30
53 20 270 213 774 -161 7 -116 830 884 708 601 614 422 16 460 739 639 -318 712 -296 -790 776 884 -472 73 -675 -730 185 -820
30
-244 183 344 958 539 -739 624 -802 817 -410 502 915 -886 -335 926 -857 124 61 -908 170 -291 -924 739 786 -183 -240 934 634 -123 375
1
-126
35
-488 24 604 103 -565 -977 40 708 56 -88 515 843 -752 406 683 871 475 255 209 -641 125 -18 36 917 737 752 439 -941 -934 142 578 -8 724 -905 -500
23
328 886 678 838 -298 665 -632 -815 -663 923 882 706 -21 496 592 754 348 -514 430 275 -925 295 342
2
-617 -156
28
-399 611 560 -801 -817 -617 -920 346 -997 -622 -30 -600 186 560 906 722 -717 740 -500 -793 721 -74 762 837 365 641 -805 -837
18
703 -101 831 -26 652 543 -464 -17 -508 286 -983 -901 -944 -65 32 -116 707 -805
27
-326 142 -965 -51 -725 -777 874 799 -434 629 969 907 -870 596 -894 905 875 -941 -807 -908 1 837 -45 -206 100 109 534
35
125 948 -100 776 -390 -146 -207 601 -866 702 -998 101 197 387 -373 224 818 300 112 618 962 375 118 -63 11 652 -560 -756 -713 727 302 711 189 -116 28
30
-485 774 -768 789 47 -185 -721 378 -937 535 -67 619 950 522 -831 865 -568 107 245 -883 925 64 821 7 555 269 -370 37 282 -813
2
310 52
4
-65 553 -282 740
8
-68 -120 753 -509 746 243 -132 516
14
299 457 939 -859 -869 125 -326 780 645 782 882 -29 -727 221
38
816 -845 -794 -156 -149 964 -29 700 509 -976 -956 -75 -991 850 351 387 -27 241 -311 565 35 805 780 -164 -935 143 992 483 565 450 -825 44 -84 -366 438 -32 166 -59
26
-166 -839 126 836 -35 810 -169 484 -293 -594 311 539 -401 -536 902 -866 449 515 -313 675 566 -166 785 -514 850 515
4
954 148 19 -422
23
-438 -467 713 -607 415 60 555 18 -25 534 641 -725 -909 698 -811 -204 51 -775 978 546 284 -261 115
25
7 476 -885 2 65 643 100 304 459 -220 869 -429 806 624 -17 -60 994 -104 571 269 -450 -847 155 -187 620
19
-171 479 914 801 -500 398 -934 286 -963 561 203 13 687 770 -519 965 -934 -21 648
32
931 -427 614 -784 681 442 434 -727 -1000 -701 -962 -453 390 68 -919 572 77 779 -400 -761 841 908 256 -495 897 -596 -964 -930 820 -161 938 126
37
262 147 759 -892 239 972 -853 949 219 781 846 -864 -971 -936 -975 435 153 -688 764 -534 27 228 255 924 991 -656 -322 -801 107 735 -733 -990 403 986 504 897 -118
39
915 -607 415 850 858 -360 219 538 989 -633 152 787 116 669 -551 -6 282 -130 -224 -626 991 -724 -903 417 -503 -450 -241 -284 643 -16 822 169 -257 749 262 560 -778 796 471
30
-698 968 -141 102 14 -600 141 -665 782 843 -477 34 -232 918 803 -269 -68 115 432 566 -67 100 528 -911 326 469 -85 -238 225 374
10
34 -599 -670 424 -663 760 -130 650 686 698
11
838 -504 203 203 -253 -644 705 833 803 209 -151
13
-830 660 -863 176 181 626 798 -797 -356 786 3 -523 -955
34
620 954 97 -849 -285 645 -516 -696 907 376 -11 117 -373 677 -280 973 -231 582 878 323 228 440 63 -728 867 -56 985 -207 246 -992 861 -148 274 -599
26
-565 108 418 502 315 449 -651 -838 681 -934 918 -882 13 -854 380 526 -470 22 912 296 796 -396 326 -937 282 -44
5
-7 -517 812 -677 -561
1
-112
34
-771 986 257 952 155 213 889 203 500 38 534 -270 -593 -165 767 -679 403 317 313 944 -783 -100 264 -591 -3 -129 503 -601 525 821 373 476 857 684
19
-183 -956 357 -32 -847 720 127 -499 748 661 182 45 879 960 -28 -832 905 -827 257
15
342 -410 894 587 376 324 126 461 -801 402 -280 989 472 -827 867
13
-711 -438 204 -49 970 889 -727 585 -531 886 -971 124 -651
17
26 -362 493 -310 15 -237 126 841 795 -388 -907 664 -890 -663 389 886 901
22
-781 326 978 -744 386 481 -902 -465 873 -456 -456 579 273 -452 -841 -619 72 -331 -87 382 -82 -13
34
-925 63 8 290 -908 394 493 512 -41 462 999 -442 -760 769 -46 -820 260 -392 58 396 -660 618 427 768 278 466 567 -403 174 -463 271 976 -631 -578
9
-799 123 -491 31 247 -579 201 -847 698
14
191 672 842 -211 96 152 -560 -55 -329 723 978 -880 343 -961`

type intHeap []int64

func (h intHeap) Len() int           { return len(h) }
func (h intHeap) Less(i, j int) bool { return h[i] < h[j] }
func (h intHeap) Swap(i, j int)      { h[i], h[j] = h[j], h[i] }
func (h *intHeap) Push(x interface{}) {
	*h = append(*h, x.(int64))
}
func (h *intHeap) Pop() interface{} {
	old := *h
	n := len(old)
	x := old[n-1]
	*h = old[:n-1]
	return x
}

type testCase struct {
	n   int
	arr []int64
}

func solveCase(tc testCase) int {
	h := &intHeap{}
	var sum int64
	for _, x := range tc.arr {
		sum += x
		heap.Push(h, x)
		if sum < 0 {
			removed := heap.Pop(h).(int64)
			sum -= removed
		}
	}
	return h.Len()
}

func parseTestcases() ([]testCase, error) {
	reader := bufio.NewReader(strings.NewReader(testcasesRaw))
	var t int
	if _, err := fmt.Fscan(reader, &t); err != nil {
		return nil, fmt.Errorf("parse t: %v", err)
	}
	res := make([]testCase, 0, t)
	for caseIdx := 0; caseIdx < t; caseIdx++ {
		var n int
		if _, err := fmt.Fscan(reader, &n); err != nil {
			return nil, fmt.Errorf("case %d: parse n: %v", caseIdx+1, err)
		}
		arr := make([]int64, n)
		for i := 0; i < n; i++ {
			if _, err := fmt.Fscan(reader, &arr[i]); err != nil {
				return nil, fmt.Errorf("case %d: parse value %d: %v", caseIdx+1, i+1, err)
			}
		}
		res = append(res, testCase{n: n, arr: arr})
	}
	return res, nil
}

func buildIfGo(path string) (string, func(), error) {
	if strings.HasSuffix(path, ".go") {
		tmp, err := os.CreateTemp("", "solbin*")
		if err != nil {
			return "", nil, err
		}
		tmp.Close()
		out, err := exec.Command("go", "build", "-o", tmp.Name(), path).CombinedOutput()
		if err != nil {
			os.Remove(tmp.Name())
			return "", nil, fmt.Errorf("build failed: %v\n%s", err, out)
		}
		return tmp.Name(), func() { os.Remove(tmp.Name()) }, nil
	}
	return path, func() {}, nil
}

func runCandidate(bin, input string) (string, error) {
	cmd := exec.Command(bin)
	cmd.Stdin = strings.NewReader(input)
	var out bytes.Buffer
	cmd.Stdout = &out
	cmd.Stderr = &out
	if err := cmd.Run(); err != nil {
		return "", fmt.Errorf("runtime error: %v\n%s", err, out.String())
	}
	return strings.TrimSpace(out.String()), nil
}

func main() {
	if len(os.Args) != 2 {
		fmt.Println("usage: go run verifierC2.go /path/to/binary")
		os.Exit(1)
	}

	cases, err := parseTestcases()
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}

	bin, cleanup, err := buildIfGo(os.Args[1])
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}
	defer cleanup()

	for i, tc := range cases {
		expected := strconv.Itoa(solveCase(tc))
		var sb strings.Builder
		sb.WriteString(strconv.Itoa(tc.n))
		sb.WriteByte('\n')
		for idx, v := range tc.arr {
			if idx > 0 {
				sb.WriteByte(' ')
			}
			sb.WriteString(strconv.FormatInt(v, 10))
		}
		sb.WriteByte('\n')

		got, err := runCandidate(bin, sb.String())
		if err != nil {
			fmt.Printf("case %d: %v\n", i+1, err)
			os.Exit(1)
		}
		if strings.TrimSpace(got) != expected {
			fmt.Printf("case %d failed\nexpected: %s\ngot: %s\n", i+1, expected, got)
			os.Exit(1)
		}
	}
	fmt.Printf("All %d tests passed\n", len(cases))
}
