package main

import (
	"bytes"
	"fmt"
	"os"
	"os/exec"
	"strconv"
	"strings"
)

// solve mirrors 1459A.go logic: compare sums of digits.
func solve(rs, bs string) string {
	sumR, sumB := 0, 0
	for i := 0; i < len(rs); i++ {
		sumR += int(rs[i] - '0')
		sumB += int(bs[i] - '0')
	}
	switch {
	case sumR > sumB:
		return "RED"
	case sumR < sumB:
		return "BLUE"
	default:
		return "EQUAL"
	}
}

type testCase struct {
	n       int
	rs, bs  string
}

// Embedded testcases from testcasesA.txt.
const testcaseData = `
7 6048764 7593824
3 194 892
5 11578 15659
4 8778 4080
2 60 97
6 351393 328711
6 871484 185839
9 947196593 423209471
2 22 01
9 684833969 477515917
10 5330413525 6012309891
1 1 3
10 9161510903 2173008691
5 13145 62087
1 9 1
7 3457923 0225841
10 7207698456 4280715084
3 375 945
10 9246610935 2337696069
7 0271427 8789007
6 470638 120665
1 3 0
1 8 9
2 31 93
5 42176 10471
5 28512 40003
5 85590 97765
9 236940224 555159004
3 294 568
3 417 304
3 814 654
7 1187755 1717604
6 229611 133060
2 68 84
8 79361534 92635110
9 731764303 921376582
2 97 29
7 6875773 8930555
1 8 2
5 92694 71180
2 32 04
1 7 5
3 275 868
9 091891634 896769930
1 2 4
9 945174466 602234500
8 62791256 09767017
3 009 925
2 85 36
8 10979519 42641830
7 7537510 0740899
4 3188 6841
3 696 116
2 16 20
8 66075415 11505520
4 5192 3031
1 4 5
1 9 3
3 271 754
3 035 574
5 85291 18942
7 2235833 2456029
1 6 1
2 26 48
7 2964513 7580660
7 5735471 2141892
8 62662375 82571734
1 7 9
8 03414892 67173864
1 1 4
1 0 4
7 8967145 4391014
5 85183 21644
9 298381686 447592211
7 6972845 7637785
8 07427093 05760811
7 0501904 4329431
7 7562566 2728523
3 756 676
4 3739 0603
2 25 02
4 9491 8456
8 08869774 73540002
6 040216 396837
4 5919 1558
8 54080351 38533444
9 647530481 077706777
2 11 31
3 637 916
9 602373245 561849834
18 897844301912633408 860164195384331845
14 57492208855902 62281237933236
16 9927190895774038 2778514296354603
11 53573452405 98025070030
11 35105623762 54256606488
97 7091662082982153230282169197299045600715427385265476048487089840761657004049438856431953985225090 9255445769620290725074931864282129188966444064488855362082965708693058235703934261973781327166446
98 59514070436666097592945067820195501318705056246292648022270808625911824345448727820928051379378252 78081850116959756851250220593060460925160759944976207436151105026905787710864081155170284006528222
99 239507603345235326759269029062200580001992260669532583861269516637636376914485809973409561802606661 797225762948155257803429546048606463522195206967116882223230827594516425858268436567846612209981399
82 1492610015751759473288182028693764092627906196538707914878674238524927117696814731 4251202983006897178551033744307585114963562343754692165873556456417417253257316678
1000 7993684735801756360906143521250300680219931730896182336670636094095557298141140292639536881817187727852646198537357607086736347723745792813481025059276367326058352889962979397037958300023793186457325857675712312678350063169968302874688119703695410390985274197436685394102599718765601692201630446154593880588027045251986149181927083518323639752458337524801545019041243885716886119752436400041558403824906649345877165280376031412270586183744667028533234228480236238292384073062686368871218010367465641293300817372984092555484207396574727455966968493363482829888754647803471039140329259400092436755196102098453635227299869300690281645930525477954172184869762962191274164415881009021667052169303600962846680782823921974443600810422821505259115347577881157668786813268521220691184945769597853806558039171569380881095052547760375207826497307992975956928663564334389573959253248289177329593187346483565003392871484765601052498748675311180985919300141962998344229322347429431262390587241949302390622780853275 7343157458943486126191827264832147568056682892049789637361186187203331966183833713182938989696479055303738302377194465419175991326307428521855153348666027142839752929643122786204791511738009174948623198273032922992114149794960127055466043319238375046988259863417434415270670489679983204164377486297420354106459356213577256665911872108673616049244818502015573359748276010153481841189403127227427908601141634637988526096934585774542237505794301782369582076775039317218869431608750394678410156663476806472666994785469250677413536095227112903208662467480272117444609457104374836160015044000902927192082111913176117782812568218083165858986439129654585000243221772442025531872453193561468505360684240415604324581273999164040092526398308378799555106527369039766226673412904212426486586771495444698078836460068140076858787879290953461312972757274758305846891428221530077198027929414527505119144952076631647676263634127554753272537218997521524511655450342282731841061677220121691419913462874526422138571586470
`

func parseTestcases() ([]testCase, error) {
	fields := strings.Fields(testcaseData)
	if len(fields) == 0 {
		return nil, fmt.Errorf("no embedded testcases")
	}
	res := make([]testCase, 0, len(fields)/3)
	for i := 0; i < len(fields); {
		if i+3 > len(fields) {
			return nil, fmt.Errorf("truncated testcase data")
		}
		n, err := strconv.Atoi(fields[i])
		if err != nil {
			return nil, fmt.Errorf("bad n at idx %d: %v", i/3+1, err)
		}
		rs := fields[i+1]
		bs := fields[i+2]
		if len(rs) != n || len(bs) != n {
			return nil, fmt.Errorf("length mismatch at case %d", i/3+1)
		}
		res = append(res, testCase{n: n, rs: rs, bs: bs})
		i += 3
	}
	return res, nil
}

func runCandidate(bin, input string) (string, error) {
	var cmd *exec.Cmd
	if strings.HasSuffix(bin, ".go") {
		cmd = exec.Command("go", "run", bin)
	} else {
		cmd = exec.Command(bin)
	}
	cmd.Stdin = strings.NewReader(input)
	var out bytes.Buffer
	var errb bytes.Buffer
	cmd.Stdout = &out
	cmd.Stderr = &errb
	if err := cmd.Run(); err != nil {
		return "", fmt.Errorf("runtime error: %v\n%s", err, errb.String())
	}
	return strings.TrimSpace(out.String()), nil
}

func main() {
	args := os.Args[1:]
	if len(args) == 2 && args[0] == "--" {
		args = args[1:]
	}
	if len(args) != 1 {
		fmt.Println("usage: go run verifierA.go /path/to/binary")
		os.Exit(1)
	}
	bin := args[0]

	tests, err := parseTestcases()
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}

	for idx, tc := range tests {
		input := fmt.Sprintf("1\n%d\n%s\n%s\n", tc.n, tc.rs, tc.bs)
		expected := solve(tc.rs, tc.bs)
		got, err := runCandidate(bin, input)
		if err != nil {
			fmt.Printf("test %d failed: %v\n", idx+1, err)
			os.Exit(1)
		}
		if strings.TrimSpace(got) != expected {
			fmt.Printf("test %d failed\ninput:\n%sexpected: %s\ngot: %s\n", idx+1, input, expected, got)
			os.Exit(1)
		}
	}
	fmt.Printf("All %d tests passed\n", len(tests))
}
