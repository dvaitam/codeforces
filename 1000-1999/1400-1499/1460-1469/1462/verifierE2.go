package main

import (
	"bytes"
	"fmt"
	"os"
	"os/exec"
	"sort"
	"strconv"
	"strings"
)

const MOD int64 = 1000000007

// Embedded copy of testcasesE2.txt so the verifier is self-contained.
const testcasesRaw = `100
49 7 4
41 23 14 30 38 37 13 30 33 7 29 13 23 39 21 22 46 45 39 40 2 28 49 42 47 7 21 25 28 24 16 9 24 25 25 46 36 19 46 45 43 13 14 5 25 14 12 13 4
22 7 21
3 4 20 18 20 2 12 5 6 12 15 14 11 10 10 11 14 6 15 22 5 22
30 3 14
18 21 12 11 4 1 30 29 23 5 23 12 11 22 7 4 23 30 10 12 20 2 4 23 15 28 21 18 28 21
40 4 2
30 31 5 16 5 14 14 39 13 23 24 1 20 18 1 22 40 4 23 11 27 6 28 36 10 30 31 35 21 1 24 2 6 30 32 1 16 34 4 7
25 2 14
5 16 19 19 10 19 13 1 18 2 19 7 6 20 6 15 6 15 7 1 17 25 2 17 16
32 7 18
30 22 7 11 3 29 32 31 18 28 15 3 3 21 25 32 16 2 13 22 13 10 19 12 28 7 17 25 14 5 24 26
10 7 9
8 2 5 7 6 6 7 6 7 5
1 1 1
1
14 2 6
1 7 14 7 4 10 7 4 11 11 12 12 11 11
27 6 4
1 7 21 10 3 7 10 3 7 6 8 19 23 25 14 21 11 10 27 6 8 21 17 16 1 25 5
32 10 5
1 20 29 18 13 9 22 20 9 12 21 26 19 23 29 31 27 12 30 14 17 27 28 32 4 22 32 22 4 21 32 24
42 8 5
6 35 19 42 19 40 28 22 42 42 30 8 23 29 42 27 35 3 26 35 23 41 1 23 2 38 31 33 40 28 15 4 20 33 35 13 39 35 14 8 33 26
8 1 5
6 6 1 8 3 1 7 5
31 5 20
24 18 30 22 8 10 6 8 30 7 31 16 24 8 8 25 9 27 12 7 30 19 23 11 5 3 26 13 7 25 7
40 10 14
25 11 32 20 40 6 7 20 14 2 4 23 6 29 19 20 32 25 18 15 36 24 34 39 7 21 26 24 8 35 10 40 31 40 38 25 34 23 18 35
10 3 2
3 2 5 1 4 9 6 7 9 6
48 2 45
48 33 46 38 47 31 2 13 35 27 2 27 43 28 38 36 36 16 7 6 22 27 35 20 42 14 32 30 12 41 42 43 38 38 19 34 35 31 24 7 47 1 22 23 30 10 35 18
4 1 4
2 4 3 2
11 10 2
11 4 9 11 3 8 1 2 9 6 6
28 6 8
4 27 14 26 24 16 24 20 19 17 3 19 20 23 19 15 10 1 11 18 16 4 22 27 22 26 18 24
20 2 20
12 2 19 6 10 6 11 16 8 13 11 18 1 12 11 19 15 7 15 14
37 10 21
28 28 31 13 11 31 4 13 3 32 1 11 7 11 34 14 8 8 28 13 34 2 11 25 11 8 27 22 33 15 30 4 8 8 13 34 7
7 5 6
1 5 1 1 2 3 4
38 9 10
20 19 37 37 15 21 18 9 32 11 22 13 16 9 26 31 25 4 38 12 2 19 7 4 28 3 10 14 20 5 13 2 37 29 25 28 31 14
18 2 12
16 14 11 1 2 4 16 15 7 15 17 1 9 8 2 8 11 17
18 1 13
12 7 8 7 11 1 4 2 3 8 12 4 18 13 9 7 6 15
29 8 8
29 19 3 25 17 18 6 23 4 26 11 27 19 6 3 23 9 23 25 14 29 10 7 5 4 22 8 21 7
20 5 2
4 5 18 16 9 5 3 4 7 20 17 8 8 5 15 7 16 20 16 4
24 7 18
6 1 14 21 19 20 5 19 23 5 23 13 12 24 17 18 7 23 7 12 8 20 16 21
4 4 4
1 3 2 3
11 1 6
8 2 9 10 7 5 10 9 3 4 11
2 2 1
1 2
19 10 10
10 1 12 9 3 1 1 15 2 5 3 2 9 10 3 3 3 8 19
40 1 21
22 39 39 30 2 35 39 32 26 19 40 2 16 23 23 21 11 27 13 26 4 2 18 39 35 14 20 10 39 1 26 17 16 2 3 40 12 29 39 10
15 10 12
14 6 5 11 7 9 12 13 2 9 8 4 5 5 1
24 10 10
19 9 8 23 10 11 17 10 9 13 16 4 23 3 14 7 21 6 22 22 7 9 12 21
34 8 29
27 14 29 22 7 14 31 20 7 2 3 5 15 28 21 33 7 6 31 19 32 30 4 20 31 24 31 9 15 4 29 16 16 15
44 1 19
8 25 22 27 23 10 38 25 30 9 27 11 15 3 24 30 43 30 8 44 22 17 39 9 20 3 13 34 19 17 16 6 30 8 35 32 21 12 20 33 7 1 14 15
24 9 6
12 11 8 10 7 21 17 2 22 13 9 10 13 9 3 21 2 1 19 5 8 18 1 18
47 3 38
40 19 43 12 11 38 32 3 42 32 39 20 36 16 44 46 44 23 8 14 15 10 10 18 34 31 20 29 19 13 22 14 9 30 31 11 33 15 28 25 18 14 23 42 20 30 44
9 7 7
8 7 4 1 5 9 1 8 1
27 10 20
6 1 1 20 9 6 3 27 2 9 11 1 23 10 13 4 13 14 24 11 25 7 23 27 26 8 6
39 8 25
21 29 35 10 37 7 19 29 8 9 20 35 16 33 22 27 37 22 5 24 32 1 8 10 9 17 18 9 16 11 23 22 33 15 16 38 3 33 13
35 8 24
12 26 31 32 14 29 35 25 20 15 8 34 30 27 18 21 6 7 10 15 32 35 12 4 30 12 34 31 9 2 16 12 13 3 22
23 8 10
11 19 11 11 3 10 21 13 3 23 16 20 21 11 19 12 14 4 4 22 1 5 18
37 6 16
2 6 36 7 20 28 25 19 21 31 4 16 18 22 27 21 4 6 5 3 21 37 9 4 20 17 15 34 21 36 14 14 9 29 25 10 6
17 7 11
11 10 14 11 7 1 14 5 11 3 5 8 17 5 16 10 2
29 8 18
5 21 17 28 13 3 20 28 20 8 27 29 15 21 14 18 11 18 8 2 27 29 1 9 20 13 23 5 8
15 10 7
14 10 14 9 14 13 3 3 11 1 12 4 15 2 10
1 1 1
1
42 1 13
16 10 14 22 27 34 27 6 24 38 6 21 42 25 8 33 21 4 5 4 19 20 3 11 7 24 23 19 11 30 28 13 42 16 6 8 27 11 32 38 34 30
35 9 12
1 7 2 31 10 14 22 4 6 33 34 17 9 17 22 28 8 26 1 19 20 27 21 32 20 4 2 32 9 8 3 14 17 15 8
41 9 15
13 33 19 28 19 30 31 40 37 27 14 14 1 14 24 11 20 14 3 36 28 27 35 22 14 9 19 6 9 4 22 4 9 5 34 8 8 4 8 10 25
40 5 2
29 7 13 39 39 33 36 1 15 11 1 37 29 17 19 39 39 12 33 39 26 21 7 11 8 36 10 31 10 1 39 3 20 14 8 17 17 29 32 15
18 10 18
14 15 10 15 8 18 14 4 14 13 7 4 12 8 1 17 3 1
46 7 23
13 46 14 22 28 7 3 32 28 20 18 25 39 18 25 38 10 41 9 2 5 12 3 21 39 24 34 30 28 13 26 4 23 44 33 25 43 43 30 37 39 26 37 17 39 38
8 3 5
3 7 5 3 2 5 7 5
49 7 40
1 32 14 34 19 13 1 49 39 44 33 20 7 27 48 49 24 47 25 24 47 39 47 25 14 21 1 4 7 40 33 45 41 42 27 8 27 22 41 15 22 22 46 23 24 10 21 22 6
17 6 9
10 5 14 13 8 4 8 9 15 5 10 5 9 2 1 8 12
22 2 15
21 2 9 5 16 7 8 11 3 4 9 16 15 10 14 12 19 18 6 3 4 5
26 5 3
18 19 23 10 17 6 23 16 14 8 12 9 9 25 11 6 9 7 4 10 25 13 13 11 15 24
7 6 1
7 7 5 2 2 4 2
38 6 18
3 9 1 24 29 19 37 20 22 12 1 38 19 11 2 29 29 8 28 31 6 3 30 28 15 18 9 38 31 29 6 23 27 35 20 32 31 29
21 10 10
3 4 4 3 8 14 15 3 19 15 21 1 18 6 5 14 18 11 6 11 6
16 8 13
6 4 12 6 15 4 5 11 2 4 10 10 9 6 7 13
31 9 1
9 21 25 31 13 19 4 10 12 18 18 13 10 10 3 15 23 8 10 16 1 8 26 1 4 1 11 14 5 10 2
7 7 7
1 7 3 4 7 3 6
9 7 5
6 5 7 7 9 5 8 7 4
46 3 43
30 19 9 7 37 12 9 17 19 18 7 21 8 1 13 5 37 45 21 34 3 18 39 42 32 28 8 11 17 44 46 13 15 39 21 12 3 4 1 13 7 44 4 32 6 20
13 9 6
12 11 7 3 13 4 12 9 12 9 10 3 8
25 4 2
17 25 20 20 14 19 23 16 5 14 20 17 17 22 3 6 19 6 11 20 6 20 14 12 21
40 7 27
19 14 26 27 38 27 33 15 30 6 1 38 31 34 3 21 22 21 31 37 19 37 34 5 4 5 19 12 18 16 6 7 37 13 3 20 28 17 6 33
39 1 2
9 15 6 28 9 38 39 23 5 14 15 31 37 6 34 15 33 30 11 30 39 24 16 9 8 20 32 33 4 26 14 28 30 38 9 25 3 36 1
33 4 24
2 9 6 7 15 11 25 24 14 5 27 13 10 15 31 27 20 23 11 18 20 26 24 16 16 13 27 9 26 19 14 11 3
21 6 20
2 10 7 16 5 21 2 6 18 7 12 15 14 8 17 5 6 16 17 20 5
46 1 39
3 26 9 4 13 44 37 25 14 31 1 26 34 35 8 17 30 4 21 31 4 32 9 45 9 45 40 23 30 21 43 4 6 13 38 43 1 6 27 18 14 8 22 16 22 31
36 7 36
13 15 26 5 32 32 2 29 13 1 13 15 20 34 11 6 32 26 26 12 2 4 5 7 32 7 5 14 26 21 18 4 33 31 34 35
48 6 42
7 43 22 17 2 18 4 43 3 26 23 1 31 37 23 12 16 48 12 33 39 40 11 18 44 29 30 9 14 18 12 45 8 43 15 9 6 18 29 31 23 42 1 10 13 23 45 16
3 1 2
1 3 1
29 5 12
29 19 4 21 21 13 9 11 13 11 13 12 27 11 7 17 10 22 23 16 28 24 28 7 2 2 9 28 29
23 3 20
19 16 10 13 8 1 5 18 9 6 13 10 20 22 9 1 12 4 19 12 22 11 17
46 6 46
39 15 33 16 17 2 33 11 21 46 34 14 40 17 23 16 26 23 35 25 21 22 43 28 26 19 15 42 35 45 7 18 6 22 30 10 35 32 35 6 17 14 11 8 18 21
36 1 22
33 1 10 24 31 7 16 25 15 17 4 1 23 35 18 21 2 33 1 25 16 30 31 19 9 25 2 14 15 28 5 6 20 5 22 9
28 2 4
7 4 6 26 7 7 18 12 28 3 17 8 22 26 22 9 25 23 7 17 7 9 26 27 3 7 27 20
45 8 16
5 38 23 1 38 20 43 12 14 2 35 42 45 30 40 41 34 23 40 15 26 9 39 24 33 33 11 32 5 14 32 24 31 39 27 17 12 1 42 32 17 3 5 39 42
47 1 23
36 31 28 37 41 32 8 13 43 4 24 25 17 23 34 39 22 9 22 10 8 47 23 6 18 23 26 7 21 38 10 25 33 19 17 23 11 37 4 8 13 31 6 21 15 17 29
11 7 11
4 9 9 9 8 3 8 3 8 8 9
47 6 44
40 44 33 45 3 14 11 5 46 21 25 32 26 40 34 26 3 38 21 10 11 17 41 45 11 38 11 30 7 39 23 40 40 15 35 41 40 26 21 9 38 34 39 29 34 7 26
25 5 11
15 19 22 21 11 13 15 4 5 16 16 15 6 25 7 24 6 23 4 21 23 21 12 5 19
34 3 29
15 15 27 31 12 3 34 18 19 33 7 2 32 18 28 3 17 31 3 31 31 34 22 31 28 18 3 5 6 15 13 14 18 21
42 9 12
35 26 15 16 33 6 2 24 1 12 20 26 31 4 10 24 39 8 20 10 25 27 32 31 21 37 11 16 23 21 40 11 37 27 25 22 21 35 27 10 29 6
42 5 25
13 2 34 29 15 20 1 1 19 40 1 4 39 16 33 22 24 23 6 33 38 18 2 9 4 5 36 22 5 38 18 10 23 41 38 42 16 39 1 28 35 22
28 7 22
13 15 22 4 17 1 15 9 22 4 12 3 16 11 17 13 13 4 18 20 1 6 14 21 27 13 12 2
4 2 3
2 4 3 4
42 6 20
42 7 24 12 32 3 30 28 18 24 13 1 24 16 40 34 8 14 25 20 11 2 27 40 24 40 30 12 38 27 19 13 36 18 23 41 39 21 25 39 39 38
27 2 13
7 2 23 26 7 16 22 24 25 11 17 8 18 24 8 16 25 23 24 16 8 25 4 5 5 24 9
50 6 9
50 3 37 44 37 46 33 25 11 25 30 3 17 30 24 41 20 25 40 28 34 5 27 31 48 20 16 2 27 19 39 29 37 38 31 25 44 22 47 23 39 9 23 20 37 30 10 34 14 20
6 4 2
3 1 2 3 5 6
31 10 2
18 30 20 6 31 22 23 14 21 7 9 1 29 21 19 12 1 22 21 11 28 11 4 21 7 3 18 13 2 31 13
46 10 19
16 9 36 7 23 36 14 45 13 42 34 27 42 11 28 41 2 18 17 6 1 29 19 18 24 3 27 3 40 3 13 39 1 10 6 13 33 42 26 27 45 21 7 7 42 16
`

var fact [200005]int64
var invfact [200005]int64

func modpow(a, e int64) int64 {
	res := int64(1)
	a %= MOD
	for e > 0 {
		if e&1 == 1 {
			res = res * a % MOD
		}
		a = a * a % MOD
		e >>= 1
	}
	return res
}

func init() {
	fact[0] = 1
	for i := 1; i < len(fact); i++ {
		fact[i] = fact[i-1] * int64(i) % MOD
	}
	invfact[len(fact)-1] = modpow(fact[len(fact)-1], MOD-2)
	for i := len(fact) - 1; i > 0; i-- {
		invfact[i-1] = invfact[i] * int64(i) % MOD
	}
}

func comb(n, k int) int64 {
	if k < 0 || n < k {
		return 0
	}
	return fact[n] * invfact[k] % MOD * invfact[n-k] % MOD
}

func solveCase(n, m, k int, arr []int) int64 {
	sort.Ints(arr)
	l := 0
	var ans int64
	for r := 0; r < n; r++ {
		for l < r && arr[r]-arr[l] > k {
			l++
		}
		w := r - l
		if w >= m-1 {
			ans = (ans + comb(w, m-1)) % MOD
		}
	}
	return ans
}

type testCase struct {
	n   int
	m   int
	k   int
	arr []int
}

func parseTestcases() ([]testCase, error) {
	fields := strings.Fields(testcasesRaw)
	if len(fields) == 0 {
		return nil, fmt.Errorf("no embedded testcases")
	}
	t, err := strconv.Atoi(fields[0])
	if err != nil {
		return nil, fmt.Errorf("invalid t: %v", err)
	}
	res := make([]testCase, 0, t)
	idx := 1
	for caseIdx := 0; caseIdx < t; caseIdx++ {
		if idx+2 >= len(fields) {
			return nil, fmt.Errorf("not enough header fields for case %d", caseIdx+1)
		}
		n, err := strconv.Atoi(fields[idx])
		if err != nil {
			return nil, fmt.Errorf("parse n%d: %v", caseIdx+1, err)
		}
		m, err := strconv.Atoi(fields[idx+1])
		if err != nil {
			return nil, fmt.Errorf("parse m%d: %v", caseIdx+1, err)
		}
		kval, err := strconv.Atoi(fields[idx+2])
		if err != nil {
			return nil, fmt.Errorf("parse k%d: %v", caseIdx+1, err)
		}
		idx += 3
		if idx+n > len(fields) {
			return nil, fmt.Errorf("not enough numbers for case %d", caseIdx+1)
		}
		arr := make([]int, n)
		for i := 0; i < n; i++ {
			v, err := strconv.Atoi(fields[idx+i])
			if err != nil {
				return nil, fmt.Errorf("parse value %d of case %d: %v", i+1, caseIdx+1, err)
			}
			arr[i] = v
		}
		idx += n
		res = append(res, testCase{n: n, m: m, k: kval, arr: arr})
	}
	if idx != len(fields) {
		return nil, fmt.Errorf("extra data after parsing")
	}
	return res, nil
}

func buildIfGo(path string) (string, func(), error) {
	if strings.HasSuffix(path, ".go") {
		tmp, err := os.CreateTemp("", "solbin*")
		if err != nil {
			return "", nil, err
		}
		tmp.Close()
		out, err := exec.Command("go", "build", "-o", tmp.Name(), path).CombinedOutput()
		if err != nil {
			os.Remove(tmp.Name())
			return "", nil, fmt.Errorf("build failed: %v\n%s", err, out)
		}
		return tmp.Name(), func() { os.Remove(tmp.Name()) }, nil
	}
	return path, func() {}, nil
}

func runCandidate(bin, input string) (string, error) {
	cmd := exec.Command(bin)
	cmd.Stdin = strings.NewReader(input)
	var out bytes.Buffer
	cmd.Stdout = &out
	cmd.Stderr = &out
	if err := cmd.Run(); err != nil {
		return "", fmt.Errorf("runtime error: %v\n%s", err, out.String())
	}
	return strings.TrimSpace(out.String()), nil
}

func main() {
	if len(os.Args) != 2 {
		fmt.Println("usage: go run verifierE2.go /path/to/binary")
		os.Exit(1)
	}

	cases, err := parseTestcases()
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}

	bin, cleanup, err := buildIfGo(os.Args[1])
	if err != nil {
		fmt.Fprintln(os.Stderr, err)
		os.Exit(1)
	}
	defer cleanup()

	for i, tc := range cases {
		var input strings.Builder
		fmt.Fprintf(&input, "1\n%d %d %d\n", tc.n, tc.m, tc.k)
		for idx, v := range tc.arr {
			if idx > 0 {
				input.WriteByte(' ')
			}
			input.WriteString(strconv.Itoa(v))
		}
		input.WriteByte('\n')

		expected := strconv.FormatInt(solveCase(tc.n, tc.m, tc.k, append([]int(nil), tc.arr...)), 10)
		got, err := runCandidate(bin, input.String())
		if err != nil {
			fmt.Printf("test %d: %v\n", i+1, err)
			os.Exit(1)
		}
		if strings.TrimSpace(got) != expected {
			fmt.Printf("test %d failed\nexpected: %s\ngot: %s\n", i+1, expected, got)
			os.Exit(1)
		}
	}
	fmt.Printf("All %d tests passed\n", len(cases))
}
